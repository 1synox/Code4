<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>UCify - Premium BGMI UC Store</title>

  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root{--bg1:#05050a;--bg2:#0f001a;--bg3:#1a0028;--stroke:rgba(255,255,255,.14);--stroke2:rgba(255,255,255,.22);--text:#ffffff;--muted:rgba(255,255,255,.78);--muted2:rgba(255,255,255,.62);--gold:#ffd700;--gold-bright:#ffed4e;--orange:#ff6b35;--mint:#00ff88;--cyan:#00d9ff;--purple:#b844ff;--error:#ff4d4d;--success:#00ff88;--shadow-sm:0 10px 26px rgba(0,0,0,.35);--shadow-md:0 18px 56px rgba(0,0,0,.48);--shadow-lg:0 28px 76px rgba(0,0,0,.62);--shadow-glow:0 0 44px rgba(255,215,0,.16);--radius:22px;--radius-sm:16px;--radius-xs:14px;--step-bg:url('bg1.jpg');}*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Poppins',sans-serif;color:var(--text);background:radial-gradient(1000px 700px at 15% -5%,rgba(255,215,0,.22),transparent 50%),radial-gradient(1000px 700px at 88% 10%,rgba(255,107,53,.20),transparent 50%),linear-gradient(145deg,var(--bg1) 0%,var(--bg2) 50%,var(--bg3) 100%);background-attachment:fixed;min-height:100vh;-webkit-user-select:none;user-select:none}.container{max-width:460px;margin:0 auto;padding:20px 16px;display:flex;flex-direction:column;gap:16px;position:relative;z-index:1}.top-card{border:1.5px solid var(--stroke);background:linear-gradient(135deg,rgba(255,255,255,.10) 0%,rgba(255,255,255,.04) 100%);backdrop-filter:blur(24px);border-radius:var(--radius);padding:22px 18px;text-align:center;box-shadow:var(--shadow-lg),var(--shadow-glow)}.logo-img{max-width:200px;filter:drop-shadow(0 4px 12px rgba(255,215,0,.32))}.progress-wrap{border:1.5px solid var(--stroke);background:rgba(255,255,255,.05);backdrop-filter:blur(16px);border-radius:var(--radius);padding:16px}.progress-container{display:flex;justify-content:space-between;align-items:center}.progress-step{width:35px;height:35px;border-radius:50%;background:rgba(255,255,255,.1);border:2px solid var(--stroke);display:flex;align-items:center;justify-content:center;font-weight:900;font-size:12px;transition:.3s}.progress-step.active{background:linear-gradient(135deg,var(--gold-bright),var(--orange));color:#000;border-color:transparent;transform:scale(1.1)}.progress-step.completed{background:var(--mint);color:#000}.progress-line{height:3px;flex:1;background:rgba(255,255,255,.1);margin:0 5px;border-radius:10px}.progress-line.active{background:var(--gold)}.step{display:none}.step.active{display:block;animation:fadeIn 0.4s ease forwards}@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.step-content{border:1.5px solid var(--stroke);background:rgba(255,255,255,.07);backdrop-filter:blur(20px);border-radius:var(--radius);padding:20px;position:relative;overflow:hidden}.step-title{font-family:'Orbitron';font-size:20px;text-align:center;margin-bottom:15px;background:linear-gradient(135deg,var(--gold-bright),var(--orange));-webkit-background-clip:text;-webkit-text-fill-color:transparent}.packs-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:15px}.pack-card{background:rgba(255,255,255,.05);border:1.5px solid var(--stroke);border-radius:16px;padding:15px;text-align:center;cursor:pointer;transition:.2s}.pack-card.selected{border-color:var(--gold);background:rgba(255,215,0,.15);transform:translateY(-3px)}.pack-uc{display:flex;align-items:center;justify-content:center;gap:5px;font-weight:800;font-size:16px;margin-bottom:5px}.uc-icon{width:24px}.form-input{width:100%;padding:14px;background:rgba(0,0,0,.3);border:1.5px solid var(--stroke);border-radius:12px;color:#fff;margin-bottom:12px;outline:none}.btn{padding:15px;border:none;border-radius:14px;font-size:15px;font-weight:900;cursor:pointer;width:100%;transition:.2s}.btn-primary{background:linear-gradient(135deg,var(--gold-bright),var(--orange));color:#000}.btn-secondary{background:rgba(255,255,255,.1);color:#fff;margin-top:10px}.btn:disabled{opacity:.4;cursor:not-allowed}.file-upload-area{border:2px dashed var(--gold);border-radius:16px;padding:20px;text-align:center;cursor:pointer;background:rgba(255,215,0,.05);margin-bottom:15px}#screenshotPreview{max-width:100%;height:150px;object-fit:contain;margin-top:10px;display:none;border-radius:8px}
  </style>
</head>

<body>

  <div class="container">
    <div class="top-card">
      <img src="ucify.png" alt="UCify" class="logo-img">
      <div style="font-size:12px; color:var(--muted); margin-top:10px; font-weight:700;">OFFICIAL BGMI PARTNER</div>
    </div>

    <div class="progress-wrap">
      <div class="progress-container">
        <div class="progress-step active" id="ps1">1</div>
        <div class="progress-line" id="pl1"></div>
        <div class="progress-step" id="ps2">2</div>
        <div class="progress-line" id="pl2"></div>
        <div class="progress-step" id="ps3">3</div>
        <div class="progress-line" id="pl3"></div>
        <div class="progress-step" id="ps4">4</div>
      </div>
    </div>

    <div id="step1" class="step active">
      <div class="step-content">
        <h2 class="step-title">Select UC Pack</h2>
        <div class="packs-grid">
          <div class="pack-card" data-uc="60" data-price="40">
            <div class="pack-uc"><img src="uc-logo.png" class="uc-icon"> 60</div>
            <div style="color:var(--gold-bright); font-weight:800;">₹40</div>
          </div>
          <div class="pack-card" data-uc="325" data-price="210">
            <div class="pack-uc"><img src="uc-logo.png" class="uc-icon"> 325</div>
            <div style="color:var(--gold-bright); font-weight:800;">₹210</div>
          </div>
          <div class="pack-card" data-uc="660" data-price="375">
            <div class="pack-uc"><img src="uc-logo.png" class="uc-icon"> 660</div>
            <div style="color:var(--gold-bright); font-weight:800;">₹375</div>
          </div>
          <div class="pack-card" data-uc="1800" data-price="950">
            <div class="pack-uc"><img src="uc-logo.png" class="uc-icon"> 1800</div>
            <div style="color:var(--gold-bright); font-weight:800;">₹950</div>
          </div>
        </div>
        <button class="btn btn-primary" id="next1" disabled>Continue</button>
      </div>
    </div>

    <div id="step2" class="step">
      <div class="step-content">
        <h2 class="step-title">Your Details</h2>
        <input type="tel" class="form-input" id="uid" placeholder="Enter BGMI UID (10 Digits)" maxlength="10">
        <input type="text" class="form-input" id="ign" placeholder="Enter In-Game Name">
        <button class="btn btn-primary" id="next2" disabled>Proceed to Pay</button>
        <button class="btn btn-secondary" onclick="showStep(1)">Back</button>
      </div>
    </div>

    <div id="step3" class="step">
      <div class="step-content">
        <h2 class="step-title">Secure Payment</h2>
        
        <div style="text-align:center; margin-bottom:15px;">
            <div style="font-weight:700; margin-bottom:10px;">Payable: <span id="payAmt" style="color:var(--gold-bright); font-size:20px;">₹0</span></div>
            
            <div style="background:white; padding:10px; display:inline-block; border-radius:15px; border:3px solid var(--gold);">
                <img id="dynamicQR" src="" style="width:180px; height:180px; display:block;">
            </div>
            <p style="font-size:11px; color:var(--muted2); margin-top:8px;">Scan with any UPI app (GPay, PhonePe, etc.)</p>
        </div>

        <div style="background:rgba(0,0,0,0.4); padding:12px; border-radius:12px; border:1px solid var(--stroke); margin-bottom:15px;">
            <p style="font-size:10px; color:var(--muted2); margin-bottom:5px; text-align:center;">OR COPY UPI ID FOR MANUAL PAYMENT</p>
            <div style="display:flex; align-items:center; justify-content:space-between;">
                <span id="vpaId" style="font-weight:800; color:var(--gold-bright); font-size:14px;">ucify@ptaxis</span>
                <button type="button" onclick="copyUPI()" id="copyBtn" style="background:var(--gold); border:none; padding:6px 12px; border-radius:6px; font-weight:900; font-size:11px; cursor:pointer;">COPY</button>
            </div>
        </div>

        <form id="orderForm" name="uc-order" method="POST" data-netlify="true" enctype="multipart/form-data">
          <input type="hidden" name="pack" id="f-pack">
          <input type="hidden" name="uid" id="f-uid">
          <input type="hidden" name="ign" id="f-ign">
          <input type="hidden" name="orderid" id="f-orderid">

          <div class="file-upload-area" onclick="document.getElementById('screenshot').click()">
            <i class="fas fa-camera" style="font-size:24px; color:var(--gold);"></i>
            <p id="uploadText" style="font-size:12px; font-weight:700; margin-top:5px;">Upload Payment Screenshot</p>
            <input type="file" id="screenshot" name="payment_screenshot" accept="image/*" style="display:none;" onchange="previewImg(this)">
            <img id="screenshotPreview">
          </div>

          <button type="submit" class="btn btn-primary" id="submitBtn" disabled>Place Order</button>
          <button type="button" class="btn btn-secondary" onclick="showStep(2)">Back</button>
        </form>
      </div>
    </div>

    <div id="step4" class="step">
      <div class="step-content" style="text-align:center;">
        <i class="fas fa-check-circle" style="font-size:50px; color:var(--mint); margin-bottom:15px;"></i>
        <h2 class="step-title" style="background:var(--mint); -webkit-background-clip:text;">Order Placed!</h2>
        <p style="font-size:14px; font-weight:700;">Order ID: <span id="finalOrderId" style="color:var(--gold);"></span></p>
        <div style="background:rgba(0,255,136,.1); padding:10px; border-radius:10px; margin:15px 0; font-size:12px;">
            UC will be added to your account within 5-10 minutes.
        </div>
        <button class="btn btn-primary" onclick="location.reload()">New Order</button>
      </div>
    </div>

  </div>

  <script>
    let selectedPack = null;
    let orderId = "";
    const UPI_VPA = "ucify@ptaxis";

    // Pack Selection Logic
    document.querySelectorAll('.pack-card').forEach(card => {
      card.addEventListener('click', function() {
        document.querySelectorAll('.pack-card').forEach(c => c.classList.remove('selected'));
        this.classList.add('selected');
        selectedPack = { uc: this.dataset.uc, price: this.dataset.price };
        document.getElementById('next1').disabled = false;
      });
    });

    document.getElementById('next1').onclick = () => showStep(2);

    // Validation for Step 2
    const uidInput = document.getElementById('uid');
    const ignInput = document.getElementById('ign');
    [uidInput, ignInput].forEach(el => el.addEventListener('input', () => {
      document.getElementById('next2').disabled = !(uidInput.value.length === 10 && ignInput.value.trim().length > 2);
    }));

    document.getElementById('next2').onclick = function() {
      orderId = "UCF-" + Math.floor(Math.random() * 900000 + 100000);
      document.getElementById('payAmt').textContent = "₹" + selectedPack.price;
      
      // Dynamic QR Generation
      const upiUrl = `upi://pay?pa=${UPI_VPA}&pn=UCify&am=${selectedPack.price}&tn=Order ${orderId}&cu=INR`;
      document.getElementById('dynamicQR').src = `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent(upiUrl)}`;
      
      showStep(3);
    };

    // Copy UPI ID
    function copyUPI() {
      navigator.clipboard.writeText(UPI_VPA).then(() => {
        const btn = document.getElementById('copyBtn');
        btn.innerText = "COPIED!";
        btn.style.background = "#00ff88";
        setTimeout(() => { btn.innerText = "COPY"; btn.style.background = "var(--gold)"; }, 2000);
      });
    }

    // Image Preview
    function previewImg(input) {
      if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const preview = document.getElementById('screenshotPreview');
          preview.src = e.target.result;
          preview.style.display = "block";
          document.getElementById('uploadText').innerText = "Screenshot Selected ✓";
          document.getElementById('submitBtn').disabled = false;
        };
        reader.readAsDataURL(input.files[0]);
      }
    }

    // Form Submission
    document.getElementById('orderForm').onsubmit = async function(e) {
      e.preventDefault();
      const btn = document.getElementById('submitBtn');
      btn.innerText = "Processing...";
      btn.disabled = true;

      document.getElementById('f-pack').value = selectedPack.uc + " UC";
      document.getElementById('f-uid').value = uidInput.value;
      document.getElementById('f-ign').value = ignInput.value;
      document.getElementById('f-orderid').value = orderId;

      const formData = new FormData(this);
      try {
        await fetch("/", { method: "POST", body: formData });
        document.getElementById('finalOrderId').innerText = orderId;
        showStep(4);
      } catch (err) {
        alert("Error submitting order. Try again.");
        btn.innerText = "Place Order";
        btn.disabled = false;
      }
    };

    function showStep(s) {
      document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
      document.getElementById('step' + s).classList.add('active');
      for(let i=1; i<=4; i++) {
        document.getElementById('ps'+i).classList.toggle('active', i === s);
        document.getElementById('ps'+i).classList.toggle('completed', i < s);
        if(i<4) document.getElementById('pl'+i).classList.toggle('active', i < s);
      }
      window.scrollTo(0,0);
    }
  </script>
</body>
</html>
